---
title: 小程序开发笔记
date: 2022-08-31 12:57:25
tags: 小程序
---
### 网络数据请求
#### 小程序中网络数据请求的限制
- 处于安全性方面的考虑，小程序官方对数据接口的请求做出了如下两个限制：
    - 只能请求HTTPS类型的接口
    - 必须将接口的域名添加到信任列表中

配置request合法域名步骤：
登录微信小程序管理后台 -> 开发 -> 开发设置 -> 服务器域名 -> 修改request合法域名

如果在开发阶段仅有http协议的接口，那么我们可以在微信开发者工具里(详情-本地设置-勾选不校验合法域名..)，临时开启`开发环境不校验请求域名、TLS版本及HTTPS证书`选项，跳过request合法域名的校验

由于小程序的宿主环境是微信客户端，所以不存在浏览器web开发中的跨域问题

### 页面导航
#### 声明式导航
用法：
1. 导航到tabBar页面
```wxml
// open-type="switchTab"
<navigator url="/pages/index/index" open-type="switchTab">导航到index tab页</navigator>
```
2. 导航到非tabBar页面
```wxml
// open-type="navigate"此时可省略
<navigator url="/pages/list/list?param1=1&param2=2" open-type="navigate">导航到list页</navigator>
```
3. 后退
```WXML
// open-type="navigateBack" delta="num" num表示后退的层级，不写该属性则默认是1
<navigator url="/pages/list/list" open-type="navigateBack">返回上一级</navigator>
```
#### 编程式导航
用法：
1. 导航到tabBar页面
```JS
wx.switchTab({
    url: 'pages/index/index',
    success?: successFun,
    fail?: failFun,
    complete?: completeFun
})
```
2. 导航到非tabBar页面
```JS
wx.navigateTo({
    url: 'pages/list/list?param1=1&param2=2',
    success?: successFun,
    fail?: failFun,
    complete?: completeFun
})
```
3. 后退
```JS
wx.navigateBack({
    delta: 1, // 默认就是后退一级
    success?: successFun,
    fail?: failFun,
    complete?: completeFun
})
```
通过导航传递的参数，可以在目标页面的onLoad生命周期函数的options参数中获取

### 自定义组件
#### 组件样式隔离的注意点
· app.wxss中的全局样式对组件无效
· 只有class选择器会有样式隔离效果，id选择器、属性选择器、标签选择器不受样式隔离的影响
所以在组件和引用组件的页面中建议使用class选择器定义样式。

#### 修改组件的样式隔离选项
默认情况下，自定义组件的样式隔离特性能够防止组件内外样式互相干扰的问题。但有时，我们希望在外界能够控制组件内部的样式，此时可通过styleIsolation修改组件的样式隔离选项，如下：
在组件的.js文件中新增如下配置
```JS
Component({
    options: {
        // 默认是isolated 组件内外样式隔离，可切换为 apply-shared:页面样式可作用到当前自定义组件, shared:表示页面wxss可以作用到当前自定义组件，当前自定义组件wxss中的样式也会作用到页面和其他设置了apply-shared或shared的自定义组件
        styleIsolation: 'isolated'
    }
})
```
或在组件的.json文件中新增styleIsolation配置
```JSON
{
    "styleIsolation": "isolated"
}
```
